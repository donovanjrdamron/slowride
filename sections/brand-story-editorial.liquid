{% liquid
  assign layout = section.settings.layout
  assign widths = '300, 450, 600, 750, 900, 1050, 1200, 1350, 1500, 1800, 2000, 2500, 3000, 3840'
  assign has_image_1 = false
  assign has_image_2 = false
  assign has_image_3 = false

  if section.settings.image_1 != blank
    assign has_image_1 = true
  endif
  if section.settings.image_2 != blank
    assign has_image_2 = true
  endif
  if section.settings.image_3 != blank
    assign has_image_3 = true
  endif
%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div
  class="section section--{{ section.settings.section_width }} color-{{ section.settings.color_scheme }} brand-editorial brand-editorial--{{ layout }}"
  style="{% render 'spacing-style', settings: section.settings %}"
>
  {% case layout %}

    {% when 'full-bleed' %}
      <div class="brand-editorial__full-bleed">
        <div class="brand-editorial__full-bleed-media">
          {%- if has_image_1 -%}
            {{
              section.settings.image_1
              | image_url: width: 3840
              | image_tag:
                width: section.settings.image_1.width,
                widths: widths,
                height: section.settings.image_1.height,
                alt: section.settings.image_1.alt,
                class: 'brand-editorial__image brand-editorial__image--cover',
                sizes: '100vw'
            }}
          {%- else -%}
            <div class="brand-editorial__placeholder">
              {{ 'lifestyle-1' | placeholder_svg_tag: 'brand-editorial__placeholder-svg' }}
            </div>
          {%- endif -%}

          {%- if section.settings.toggle_overlay -%}
            {% render 'overlay', settings: section.settings %}
          {%- endif -%}
        </div>

        {%- if section.settings.heading != blank or section.settings.body_text != blank or section.settings.caption != blank -%}
          <div class="brand-editorial__full-bleed-content brand-editorial__full-bleed-content--{{ section.settings.text_position }}">
            {%- if section.settings.caption != blank -%}
              <p class="brand-editorial__caption">{{ section.settings.caption }}</p>
            {%- endif -%}
            {%- if section.settings.heading != blank -%}
              <h2 class="brand-editorial__heading">{{ section.settings.heading }}</h2>
            {%- endif -%}
            {%- if section.settings.body_text != blank -%}
              <div class="brand-editorial__body rte">{{ section.settings.body_text }}</div>
            {%- endif -%}
          </div>
        {%- endif -%}
      </div>

    {% when 'two-column' %}
      <div class="brand-editorial__two-column">
        <div class="brand-editorial__two-column-media">
          <div class="brand-editorial__two-column-item">
            {%- if has_image_1 -%}
              {{
                section.settings.image_1
                | image_url: width: 2000
                | image_tag:
                  width: section.settings.image_1.width,
                  widths: widths,
                  height: section.settings.image_1.height,
                  alt: section.settings.image_1.alt,
                  class: 'brand-editorial__image',
                  sizes: '(min-width: 750px) 50vw, 100vw'
              }}
            {%- else -%}
              <div class="brand-editorial__placeholder">
                {{ 'lifestyle-1' | placeholder_svg_tag: 'brand-editorial__placeholder-svg' }}
              </div>
            {%- endif -%}
          </div>
          <div class="brand-editorial__two-column-item">
            {%- if has_image_2 -%}
              {{
                section.settings.image_2
                | image_url: width: 2000
                | image_tag:
                  width: section.settings.image_2.width,
                  widths: widths,
                  height: section.settings.image_2.height,
                  alt: section.settings.image_2.alt,
                  class: 'brand-editorial__image',
                  sizes: '(min-width: 750px) 50vw, 100vw'
              }}
            {%- else -%}
              <div class="brand-editorial__placeholder">
                {{ 'lifestyle-2' | placeholder_svg_tag: 'brand-editorial__placeholder-svg' }}
              </div>
            {%- endif -%}
          </div>
        </div>

        {%- if section.settings.heading != blank or section.settings.body_text != blank or section.settings.caption != blank -%}
          <div class="brand-editorial__two-column-text">
            {%- if section.settings.caption != blank -%}
              <p class="brand-editorial__caption">{{ section.settings.caption }}</p>
            {%- endif -%}
            {%- if section.settings.heading != blank -%}
              <h2 class="brand-editorial__heading">{{ section.settings.heading }}</h2>
            {%- endif -%}
            {%- if section.settings.body_text != blank -%}
              <div class="brand-editorial__body rte">{{ section.settings.body_text }}</div>
            {%- endif -%}
          </div>
        {%- endif -%}
      </div>

    {% when 'mosaic' %}
      <div class="brand-editorial__mosaic brand-editorial__mosaic--{{ section.settings.text_position }}">
        <div class="brand-editorial__mosaic-large">
          {%- if has_image_1 -%}
            {{
              section.settings.image_1
              | image_url: width: 2500
              | image_tag:
                width: section.settings.image_1.width,
                widths: widths,
                height: section.settings.image_1.height,
                alt: section.settings.image_1.alt,
                class: 'brand-editorial__image',
                sizes: '(min-width: 750px) 58vw, 100vw'
            }}
          {%- else -%}
            <div class="brand-editorial__placeholder">
              {{ 'lifestyle-1' | placeholder_svg_tag: 'brand-editorial__placeholder-svg' }}
            </div>
          {%- endif -%}
        </div>

        <div class="brand-editorial__mosaic-stack">
          <div class="brand-editorial__mosaic-small">
            {%- if has_image_2 -%}
              {{
                section.settings.image_2
                | image_url: width: 1500
                | image_tag:
                  width: section.settings.image_2.width,
                  widths: widths,
                  height: section.settings.image_2.height,
                  alt: section.settings.image_2.alt,
                  class: 'brand-editorial__image',
                  sizes: '(min-width: 750px) 38vw, 100vw'
              }}
            {%- else -%}
              <div class="brand-editorial__placeholder">
                {{ 'lifestyle-2' | placeholder_svg_tag: 'brand-editorial__placeholder-svg' }}
              </div>
            {%- endif -%}
          </div>
          <div class="brand-editorial__mosaic-small">
            {%- if has_image_3 -%}
              {{
                section.settings.image_3
                | image_url: width: 1500
                | image_tag:
                  width: section.settings.image_3.width,
                  widths: widths,
                  height: section.settings.image_3.height,
                  alt: section.settings.image_3.alt,
                  class: 'brand-editorial__image',
                  sizes: '(min-width: 750px) 38vw, 100vw'
              }}
            {%- else -%}
              <div class="brand-editorial__placeholder">
                {{ 'collection-1' | placeholder_svg_tag: 'brand-editorial__placeholder-svg' }}
              </div>
            {%- endif -%}
          </div>
        </div>

        {%- if section.settings.heading != blank or section.settings.body_text != blank or section.settings.caption != blank -%}
          <div class="brand-editorial__mosaic-text">
            {%- if section.settings.caption != blank -%}
              <p class="brand-editorial__caption">{{ section.settings.caption }}</p>
            {%- endif -%}
            {%- if section.settings.heading != blank -%}
              <h2 class="brand-editorial__heading">{{ section.settings.heading }}</h2>
            {%- endif -%}
            {%- if section.settings.body_text != blank -%}
              <div class="brand-editorial__body rte">{{ section.settings.body_text }}</div>
            {%- endif -%}
          </div>
        {%- endif -%}
      </div>

    {% when 'text-feature' %}
      <div class="brand-editorial__text-feature">
        {%- if has_image_1 -%}
          <div class="brand-editorial__text-feature-image brand-editorial__text-feature-image--left">
            {{
              section.settings.image_1
              | image_url: width: 800
              | image_tag:
                width: section.settings.image_1.width,
                widths: widths,
                height: section.settings.image_1.height,
                alt: section.settings.image_1.alt,
                class: 'brand-editorial__image',
                sizes: '(min-width: 750px) 20vw, 40vw'
            }}
          </div>
        {%- endif -%}

        <div class="brand-editorial__text-feature-content">
          {%- if section.settings.caption != blank -%}
            <p class="brand-editorial__caption">{{ section.settings.caption }}</p>
          {%- endif -%}
          {%- if section.settings.heading != blank -%}
            <h2 class="brand-editorial__heading brand-editorial__heading--feature">{{ section.settings.heading }}</h2>
          {%- endif -%}
          {%- if section.settings.body_text != blank -%}
            <div class="brand-editorial__body rte">{{ section.settings.body_text }}</div>
          {%- endif -%}
        </div>

        {%- if has_image_2 -%}
          <div class="brand-editorial__text-feature-image brand-editorial__text-feature-image--right">
            {{
              section.settings.image_2
              | image_url: width: 800
              | image_tag:
                width: section.settings.image_2.width,
                widths: widths,
                height: section.settings.image_2.height,
                alt: section.settings.image_2.alt,
                class: 'brand-editorial__image',
                sizes: '(min-width: 750px) 20vw, 40vw'
            }}
          </div>
        {%- endif -%}
      </div>

  {% endcase %}
</div>

{% stylesheet %}
  .brand-editorial {
    overflow: hidden;
  }

  .brand-editorial__image {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .brand-editorial__image--cover {
    position: absolute;
    inset: 0;
  }

  .brand-editorial__placeholder {
    width: 100%;
    height: 100%;
    min-height: 250px;
    background: rgba(from var(--color-foreground) r g b / 0.05);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .brand-editorial__placeholder-svg {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .brand-editorial__caption {
    font-size: 0.75rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    opacity: 0.7;
    margin: 0;
  }

  .brand-editorial__heading {
    margin: 0;
    font-family: var(--font-heading--family);
    font-weight: var(--font-heading--weight);
    line-height: 1.15;
  }

  .brand-editorial__heading--feature {
    font-size: clamp(1.75rem, 4vw, 3.5rem);
  }

  .brand-editorial__body {
    max-width: 60ch;
  }

  .brand-editorial__body p {
    margin: 0;
  }

  /* ===================== Full Bleed ===================== */

  .brand-editorial__full-bleed {
    position: relative;
    min-height: 60svh;

    @media screen and (width >= 750px) {
      min-height: 75svh;
    }
  }

  .brand-editorial__full-bleed-media {
    position: absolute;
    inset: 0;
  }

  .brand-editorial__full-bleed-content {
    position: relative;
    z-index: var(--layer-flat, 1);
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: var(--page-margin);
    min-height: 60svh;

    @media screen and (width >= 750px) {
      padding: calc(2 * var(--page-margin));
      min-height: 75svh;
      max-width: 50%;
    }
  }

  .brand-editorial__full-bleed-content--bottom-left {
    justify-content: flex-end;
    align-items: flex-start;
  }

  .brand-editorial__full-bleed-content--bottom-right {
    justify-content: flex-end;
    align-items: flex-end;
    text-align: right;

    @media screen and (width >= 750px) {
      margin-inline-start: auto;
    }
  }

  .brand-editorial__full-bleed-content--top-left {
    justify-content: flex-start;
    align-items: flex-start;
  }

  .brand-editorial__full-bleed-content--center {
    justify-content: center;
    align-items: center;
    text-align: center;

    @media screen and (width >= 750px) {
      max-width: 65%;
      margin-inline: auto;
    }
  }

  /* ===================== Two Column ===================== */

  .brand-editorial__two-column {
    display: flex;
    flex-direction: column;
    gap: clamp(24px, 3vw, 48px);
  }

  .brand-editorial__two-column-media {
    display: grid;
    grid-template-columns: 1fr;
    gap: clamp(8px, 1.5vw, 24px);

    @media screen and (width >= 750px) {
      grid-template-columns: 1fr 1fr;
    }
  }

  .brand-editorial__two-column-item {
    overflow: hidden;
    aspect-ratio: 3 / 4;
  }

  .brand-editorial__two-column-text {
    display: flex;
    flex-direction: column;
    gap: 12px;
    max-width: 65ch;
  }

  .section--page-width .brand-editorial__two-column-text {
    padding-inline: 0;
  }

  .section--full-width .brand-editorial__two-column-text {
    padding-inline: var(--page-margin);
  }

  /* ===================== Mosaic ===================== */

  .brand-editorial__mosaic {
    display: grid;
    grid-template-columns: 1fr;
    gap: clamp(8px, 1.5vw, 24px);

    @media screen and (width >= 750px) {
      grid-template-columns: repeat(12, 1fr);
      grid-template-rows: auto auto;
    }
  }

  .brand-editorial__mosaic-large {
    aspect-ratio: 4 / 5;
    overflow: hidden;

    @media screen and (width >= 750px) {
      grid-column: 1 / 8;
      grid-row: 1 / 3;
      aspect-ratio: auto;
    }
  }

  .brand-editorial__mosaic--right .brand-editorial__mosaic-large {
    @media screen and (width >= 750px) {
      grid-column: 6 / 13;
    }
  }

  .brand-editorial__mosaic-stack {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: clamp(8px, 1.5vw, 24px);

    @media screen and (width >= 750px) {
      grid-column: 8 / 13;
      grid-row: 1 / 2;
      grid-template-columns: 1fr;
      grid-template-rows: 1fr 1fr;
    }
  }

  .brand-editorial__mosaic--right .brand-editorial__mosaic-stack {
    @media screen and (width >= 750px) {
      grid-column: 1 / 6;
      grid-row: 1 / 2;
      order: -1;
    }
  }

  .brand-editorial__mosaic-small {
    aspect-ratio: 1 / 1;
    overflow: hidden;

    @media screen and (width >= 750px) {
      aspect-ratio: auto;
    }
  }

  .brand-editorial__mosaic-text {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding-block: clamp(16px, 2vw, 32px);

    @media screen and (width >= 750px) {
      grid-column: 8 / 13;
      grid-row: 2 / 3;
      padding-block: 0;
      padding-block-start: clamp(16px, 2vw, 32px);
    }
  }

  .brand-editorial__mosaic--right .brand-editorial__mosaic-text {
    @media screen and (width >= 750px) {
      grid-column: 1 / 6;
      grid-row: 2 / 3;
    }
  }

  .section--full-width .brand-editorial__mosaic-text {
    padding-inline: var(--page-margin);
  }

  /* ===================== Text Feature ===================== */

  .brand-editorial__text-feature {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: clamp(24px, 4vw, 64px);
    padding-block: clamp(32px, 5vw, 80px);

    @media screen and (width >= 750px) {
      flex-direction: row;
      justify-content: center;
    }
  }

  .brand-editorial__text-feature-content {
    display: flex;
    flex-direction: column;
    gap: 16px;
    text-align: center;
    max-width: 55ch;
    flex: 1;

    @media screen and (width >= 750px) {
      flex: 0 1 50%;
    }
  }

  .brand-editorial__text-feature-image {
    flex: 0 0 auto;
    width: 40%;
    max-width: 260px;
    aspect-ratio: 3 / 4;
    overflow: hidden;
    display: none;

    @media screen and (width >= 750px) {
      display: block;
    }
  }

  .brand-editorial__text-feature-image--left {
    order: -1;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Brand story editorial",
  "tag": "section",
  "class": "section-wrapper",
  "disabled_on": {
    "groups": ["header"]
  },
  "settings": [
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        {
          "value": "full-bleed",
          "label": "Full bleed image"
        },
        {
          "value": "two-column",
          "label": "Two column images"
        },
        {
          "value": "mosaic",
          "label": "Mosaic grid"
        },
        {
          "value": "text-feature",
          "label": "Text feature"
        }
      ],
      "default": "mosaic"
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Our Story"
    },
    {
      "type": "richtext",
      "id": "body_text",
      "label": "Body text",
      "default": "<p>Share the journey behind your brand. Tell your customers what drives you, where you started, and where you're headed.</p>"
    },
    {
      "type": "text",
      "id": "caption",
      "label": "Caption",
      "default": "Est. 2020"
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Image 1"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Image 2"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Image 3",
      "info": "Used in mosaic layout only"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "text_position",
      "label": "Text position",
      "options": [
        {
          "value": "bottom-left",
          "label": "Bottom left"
        },
        {
          "value": "bottom-right",
          "label": "Bottom right"
        },
        {
          "value": "top-left",
          "label": "Top left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "bottom-left",
      "info": "Full bleed: overlay text position. Mosaic: which side the large image sits on (left/right)."
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Section width",
      "options": [
        {
          "value": "page-width",
          "label": "Page width"
        },
        {
          "value": "full-width",
          "label": "Full width"
        }
      ],
      "default": "page-width"
    },
    {
      "type": "header",
      "content": "Appearance"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "checkbox",
      "id": "toggle_overlay",
      "label": "Image overlay",
      "default": false,
      "info": "Applies to full bleed layout"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "alpha": true,
      "default": "#00000040",
      "visible_if": "{{ section.settings.toggle_overlay }}"
    },
    {
      "type": "select",
      "id": "overlay_style",
      "label": "Overlay style",
      "options": [
        {
          "value": "solid",
          "label": "Solid"
        },
        {
          "value": "gradient",
          "label": "Gradient"
        }
      ],
      "default": "gradient",
      "visible_if": "{{ section.settings.toggle_overlay }}"
    },
    {
      "type": "select",
      "id": "gradient_direction",
      "label": "Gradient direction",
      "options": [
        {
          "value": "to top",
          "label": "Up"
        },
        {
          "value": "to bottom",
          "label": "Down"
        }
      ],
      "default": "to top",
      "visible_if": "{{ section.settings.toggle_overlay and section.settings.overlay_style == 'gradient' }}"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 24
    }
  ],
  "presets": [
    {
      "name": "Editorial: Mosaic",
      "category": "t:categories.storytelling",
      "settings": {
        "layout": "mosaic",
        "heading": "Our Story",
        "body_text": "<p>Share the journey behind your brand. Tell your customers what drives you, where you started, and where you're headed.</p>",
        "caption": "The Beginning",
        "text_position": "left",
        "section_width": "page-width",
        "padding-block-start": 48,
        "padding-block-end": 48
      }
    },
    {
      "name": "Editorial: Full bleed",
      "category": "t:categories.storytelling",
      "settings": {
        "layout": "full-bleed",
        "heading": "Built for the ride",
        "body_text": "<p>Every piece we make tells a story.</p>",
        "caption": "",
        "text_position": "bottom-left",
        "section_width": "full-width",
        "toggle_overlay": true,
        "overlay_style": "gradient",
        "color_scheme": "scheme-5",
        "padding-block-start": 0,
        "padding-block-end": 0
      }
    },
    {
      "name": "Editorial: Two column",
      "category": "t:categories.storytelling",
      "settings": {
        "layout": "two-column",
        "heading": "Side by Side",
        "body_text": "<p>Two perspectives, one vision. Our process from start to finish.</p>",
        "caption": "Behind the Scenes",
        "section_width": "page-width",
        "padding-block-start": 48,
        "padding-block-end": 48
      }
    },
    {
      "name": "Editorial: Text feature",
      "category": "t:categories.storytelling",
      "settings": {
        "layout": "text-feature",
        "heading": "We believe in doing things differently",
        "body_text": "<p>Quality over quantity. Every detail matters. This is the ethos that drives everything we create.</p>",
        "caption": "Our Philosophy",
        "section_width": "page-width",
        "padding-block-start": 64,
        "padding-block-end": 64
      }
    }
  ]
}
{% endschema %}
